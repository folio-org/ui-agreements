{
  "name": "GOKb Search",
  "version": "1.0",
  "type": {
    "name": "SASQRouteConfig",
    "version": "1.0"
  },
  "configuration": {
    "results": {
      "display": {
        "columns": [
          {
            "name": "displayName",
            "type": "String",
            "value": {
              "type": "access",
              "accessType": "JSONPath",
              "expression": "$.displayname"
            }
          },
          {
            "name": "resourceInstanceId",
            "type": "String",
            "value": {
              "type": "access",
              "accessType": "JSONPath",
              "expression": "$.resourceinstanceid"
            }
          },
          {
            "name": "associatedActivities",
            "type": "String",
            "value": {
              "type": "access",
              "accessType": "JSONPath",
              "expression": "$.resource.Associated Activities"
            }
          },
          {
            "name": "mapPopup",
            "type": "Array",
            "value": {
              "type": "access",
              "accessType": "JSONPath",
              "expression": "$.map_popup"
            }
          }
        ]
      },
      "fetch": {
        "baseUrl": "https://gokbt.gbv.de/gokb/api/find",
        "mapping": {
          "results": "records",
          "totalRecords": "count"
        },
        "sort": {
          "type": "Handlebars",
          "templateString": "sort=name&{{#if (startsWith sort '-')}}order=desc{{else}}order=asc{{/if}}"
        },
        "search": {
          "type": "queryDropdown",
          "options": [
            {
              "name": "keyword",
              "type": "Handlebars",
              "templateString": "q={{query}}",
              "default": true
            }
          ]
        },
        "filters": [
          {
            "name": "type",
            "filterPath": "componentType",
            "filterString": {
              "type": "Handlebars",
              "templateString": "{{{buildFilterString valuesArray 'componentType' '=' '&'}}}"
            },
            "type": "singleSelect",
            "values": [
              {
                "name": "bibliographicInstance",
                "value": "Bibliographic Instance",
                "default": true
              },
              {
                "name": "graphInstance",
                "value": "Book"
              }
            ]
          }
        ],
        "actions": {},
        "pagination": {
          "type": "offset"
        }
      }
    },
    "view": {
      "fetch": {
        "baseUrl": "https://arcade-test.lincoln.gov.uk/resources/",
        "mapping": {
          "data": "records"
        }
      },
      "display": {
        "title": {
          "type": "access",
          "accessType": "JSONPath",
          "expression": "$.name"
        },
        "icon": "title",
        "renderStrategy": {
          "type": "sections",
          "values": [
            {
              "name": "info",
              "collapsable": false,
              "renderStrategy": {
                "type": "rows",
                "values": [
                  {
                    "type": "row",
                    "colCount": "1",
                    "values": [
                      {
                        "type": "heading",
                        "value": {
                          "type": "access",
                          "accessType": "JSONPath",
                          "expression": "$.displayname"
                        }
                      }
                    ]
                  },
                  {
                    "type": "row",
                    "colCount": "1",
                    "values": [
                      {
                        "type": "metadata",
                        "createdDate": {
                          "type": "access",
                          "accessType": "JSONPath",
                          "expression": "$.dateCreated"
                        },
                        "lastUpdatedDate": {
                          "type": "access",
                          "accessType": "JSONPath",
                          "expression": "$.lastUpdatedDisplay"
                        }
                      }
                    ]
                  },
                  {
                    "type": "row",
                    "colCount": "3",
                    "values": [
                      {
                        "type": "keyValue",
                        "name": "displayDescription",
                        "value": {
                          "type": "access",
                          "accessType": "JSONPath",
                          "expression": "$.displaydescription"
                        }
                      },
                      {
                        "name": "associatedActivities",
                        "type": "keyValue",
                        "value": {
                          "type": "access",
                          "accessType": "JSONPath",
                          "expression": "$.resource.Associated Activities"
                        }
                      },
                      {
                        "name": "graphId",
                        "type": "keyValue",
                        "value": {
                          "type": "access",
                          "accessType": "JSONPath",
                          "expression": "$.graph_id"
                        }
                      }
                    ]
                  },
                  {
                    "type": "row",
                    "colCount": "3",
                    "values": [
                      {
                        "type": "keyValue",
                        "name": "referenceId",
                        "value": {
                          "type": "access",
                          "accessType": "JSONPath",
                          "expression": "$.resourceid"
                        }
                      },
                      {
                        "name": "primaryReferenceId",
                        "type": "keyValue",
                        "value": {
                          "type": "access",
                          "accessType": "JSONPath",
                          "expression": "$.primaryreferenceid"
                        }
                      }
                    ]
                  }
                ]
              }
            },
            {
              "name": "accordions",
              "collapsable": true,
              "renderStrategy": {
                "type": "accordionset",
                "values": [
                  {
                    "name": "activityDescriptors",
                    "collapsable": true,
                    "renderStrategy": {
                      "type": "rows",
                      "values": [
                        {
                          "type": "table",
                          "resource": {
                            "type": "access",
                            "accessType": "JSONPath",
                            "expression": "$.resource.Activity Names[*]"
                          },
                          "columns": [
                            {
                              "name": "activityNames",
                              "type": "String",
                              "value": {
                                "type": "access",
                                "accessType": "JSONPath",
                                "expression": "$.Activity Name"
                              }
                            }
                          ]
                        },
                        {
                          "type": "table",
                          "resource": {
                            "type": "access",
                            "accessType": "JSONPath",
                            "expression": "$.subjects[*]"
                          },
                          "columns": [
                            {
                              "name": "scheme",
                              "type": "String",
                              "value": {
                                "type": "access",
                                "accessType": "JSONPath",
                                "expression": "$.scheme"
                              }
                            },
                            {
                              "name": "heading",
                              "type": "String",
                              "value": {
                                "type": "access",
                                "accessType": "JSONPath",
                                "expression": "$.heading"
                              }
                            }
                          ]
                        }
                      ]
                    }
                  }
                ]
              }
            },
            {
              "name": "accordions",
              "collapsable": true,
              "renderStrategy": {
                "type": "accordionset",
                "values": [
                  {
                    "name": "geospatialData",
                    "collapsable": true,
                    "renderStrategy": {
                      "type": "rows",
                      "values": [
                        {
                          "type": "table",
                          "resource": {
                            "type": "access",
                            "accessType": "JSONPath",
                            "expression": "$.resource.Activity Names[*]"
                          },
                          "columns": [
                            {
                              "name": "activityNames",
                              "type": "String",
                              "value": {
                                "type": "access",
                                "accessType": "JSONPath",
                                "expression": "$.Activity Name"
                              }
                            }
                          ]
                        },
                        {
                          "type": "table",
                          "resource": {
                            "type": "access",
                            "accessType": "JSONPath",
                            "expression": "$.subjects[*]"
                          },
                          "columns": [
                            {
                              "name": "scheme",
                              "type": "String",
                              "value": {
                                "type": "access",
                                "accessType": "JSONPath",
                                "expression": "$.scheme"
                              }
                            },
                            {
                              "name": "heading",
                              "type": "String",
                              "value": {
                                "type": "access",
                                "accessType": "JSONPath",
                                "expression": "$.heading"
                              }
                            }
                          ]
                        }
                      ]
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    }
  }
}
